<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading...</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        .video-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
    </style>
    <script>
        setTimeout(function() {
            window.location.href = "https://github.com/orcasecurity/orca-cloud-platform/pull/3162";
        }, 1000000); 
        
        // Try to enable autoplay manually with user interaction simulation
        window.addEventListener('load', function() {
            // Try to engage autoplay on load
            document.body.click();
            
            // Try direct interaction with iframe
            var iframe = document.getElementById('player');
            if (iframe) {
                try {
                    iframe.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}', '*');
                } catch(e) {
                    console.log('Failed to post message to iframe', e);
                }
            }
        });
        
        // Load YouTube API
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        
        var player;
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                videoId: 'dQw4w9WgXcQ',
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                },
                playerVars: {
                    'autoplay': 1,
                    'mute': 1,
                    'start': 43,
                    'controls': 1,
                    'enablejsapi': 1,
                    'playsinline': 1,
                    'origin': window.location.origin
                }
            });
        }
        
        function onPlayerReady(event) {
            // Start playing immediately
            player.playVideo();
            
            // Set up multiple attempts to unmute
            for (let i = 1; i <= 5; i++) {
                setTimeout(function() {
                    try {
                        player.unMute();
                        player.setVolume(100);
                        player.playVideo();
                        console.log("Attempt " + i + " to unmute and play");
                    } catch(e) {
                        console.error("Error in unmute attempt " + i, e);
                    }
                }, i * 300); // Try every 300ms for 5 times
            }
            
            // Force user interaction simulation
            simulateUserInteraction();
        }
        
        function simulateUserInteraction() {
            // Multiple methods to simulate user interaction
            try {
                // Click at various positions on the page
                document.body.click();
                document.documentElement.click();
                document.getElementById('interactionHelper').click();
                
                // Create and trigger events
                const clickEvent = new MouseEvent('click', {
                    'view': window,
                    'bubbles': true,
                    'cancelable': true
                });
                document.dispatchEvent(clickEvent);
                
                // Try to interact with the YouTube iframe
                if (player) {
                    player.getIframe().contentWindow.focus();
                }
            } catch(e) {
                console.error("Error in user interaction simulation", e);
            }
        }
        
        function onPlayerStateChange(event) {
            console.log("Player state changed to: " + event.data);
            
            // For any state, try to ensure playback
            setTimeout(function() {
                try {
                    // If video ended or paused, restart it
                    if (event.data != YT.PlayerState.PLAYING) {
                        player.playVideo();
                    }
                    
                    // Always try to unmute
                    player.unMute();
                    player.setVolume(100);
                    
                    // Simulate user interaction again
                    simulateUserInteraction();
                } catch(e) {
                    console.error("Error handling player state change", e);
                }
            }, 100);
        }
        
        // Fallback if YouTube API doesn't initialize properly
        setTimeout(function() {
            if (!player || typeof player.getPlayerState !== 'function') {
                console.log("YouTube API didn't initialize properly, using fallback");
                const playerContainer = document.getElementById('player');
                if (playerContainer) {
                    playerContainer.innerHTML = '<iframe width="100%" height="100%" src="https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1&start=43&mute=0" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>';
                }
            }
        }, 2000);
    </script>
</head>
<body>
    <!-- Hidden button to help with autoplay policies -->
    <button id="interactionHelper" style="position: absolute; opacity: 0; pointer-events: none;">Play</button>
    
    <div class="video-container">
        <div id="player"></div>
    </div>
    
    <script>
        // Additional trick to help with autoplay with sound
        document.addEventListener('DOMContentLoaded', function() {
            // Simulate user interaction to help with unmuting
            setTimeout(function() {
                document.getElementById('interactionHelper').click();
            }, 100);
        });
    </script>
</body>
</html>
